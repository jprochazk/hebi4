---
source: src/parser/tests.rs
expression: snapshot
---
SOURCE
//parse

fn selection_sort(arr) {
  let n = len(arr)
  let i = 0
  loop {
    if i >= n - 1 {
      break
    }

    let min_idx = i
    let j = i + 1
    loop {
      if j >= n {
        break
      }
      if arr[j] < arr[min_idx] {
        min_idx = j
      }
      j = j + 1
    }

    if min_idx != i {
      let tmp = arr[i]
      arr[i] = arr[min_idx]
      arr[min_idx] = tmp
    }

    i = i + 1
  }

  return arr
}



OK
Root(
    [
        FuncDecl(
            Ident(
                "selection_sort",
            ),
            Block(
                [
                    Var(
                        Ident(
                            "n",
                        ),
                        Call(
                            GetVar(
                                Ident(
                                    "len",
                                ),
                            ),
                            [
                                GetVar(
                                    Ident(
                                        "arr",
                                    ),
                                ),
                            ],
                        ),
                    ),
                    Var(
                        Ident(
                            "i",
                        ),
                        Int32(
                            0,
                        ),
                    ),
                    Loop(
                        [
                            StmtExpr(
                                IfSimple(
                                    Infix(
                                        Ge,
                                        GetVar(
                                            Ident(
                                                "i",
                                            ),
                                        ),
                                        Infix(
                                            Sub,
                                            GetVar(
                                                Ident(
                                                    "n",
                                                ),
                                            ),
                                            Int32(
                                                1,
                                            ),
                                        ),
                                    ),
                                    None,
                                    [
                                        StmtExpr(
                                            Break,
                                        ),
                                    ],
                                ),
                            ),
                            Var(
                                Ident(
                                    "min_idx",
                                ),
                                GetVar(
                                    Ident(
                                        "i",
                                    ),
                                ),
                            ),
                            Var(
                                Ident(
                                    "j",
                                ),
                                Infix(
                                    Add,
                                    GetVar(
                                        Ident(
                                            "i",
                                        ),
                                    ),
                                    Int32(
                                        1,
                                    ),
                                ),
                            ),
                            Loop(
                                [
                                    StmtExpr(
                                        IfSimple(
                                            Infix(
                                                Ge,
                                                GetVar(
                                                    Ident(
                                                        "j",
                                                    ),
                                                ),
                                                GetVar(
                                                    Ident(
                                                        "n",
                                                    ),
                                                ),
                                            ),
                                            None,
                                            [
                                                StmtExpr(
                                                    Break,
                                                ),
                                            ],
                                        ),
                                    ),
                                    StmtExpr(
                                        IfSimple(
                                            Infix(
                                                Lt,
                                                GetIndex(
                                                    GetVar(
                                                        Ident(
                                                            "arr",
                                                        ),
                                                    ),
                                                    GetVar(
                                                        Ident(
                                                            "j",
                                                        ),
                                                    ),
                                                ),
                                                GetIndex(
                                                    GetVar(
                                                        Ident(
                                                            "arr",
                                                        ),
                                                    ),
                                                    GetVar(
                                                        Ident(
                                                            "min_idx",
                                                        ),
                                                    ),
                                                ),
                                            ),
                                            None,
                                            [
                                                StmtExpr(
                                                    SetVar(
                                                        None,
                                                        GetVar(
                                                            Ident(
                                                                "min_idx",
                                                            ),
                                                        ),
                                                        GetVar(
                                                            Ident(
                                                                "j",
                                                            ),
                                                        ),
                                                    ),
                                                ),
                                            ],
                                        ),
                                    ),
                                    StmtExpr(
                                        SetVar(
                                            None,
                                            GetVar(
                                                Ident(
                                                    "j",
                                                ),
                                            ),
                                            Infix(
                                                Add,
                                                GetVar(
                                                    Ident(
                                                        "j",
                                                    ),
                                                ),
                                                Int32(
                                                    1,
                                                ),
                                            ),
                                        ),
                                    ),
                                ],
                            ),
                            StmtExpr(
                                IfSimple(
                                    Infix(
                                        Ne,
                                        GetVar(
                                            Ident(
                                                "min_idx",
                                            ),
                                        ),
                                        GetVar(
                                            Ident(
                                                "i",
                                            ),
                                        ),
                                    ),
                                    None,
                                    [
                                        Var(
                                            Ident(
                                                "tmp",
                                            ),
                                            GetIndex(
                                                GetVar(
                                                    Ident(
                                                        "arr",
                                                    ),
                                                ),
                                                GetVar(
                                                    Ident(
                                                        "i",
                                                    ),
                                                ),
                                            ),
                                        ),
                                        StmtExpr(
                                            SetIndex(
                                                None,
                                                GetIndex(
                                                    GetVar(
                                                        Ident(
                                                            "arr",
                                                        ),
                                                    ),
                                                    GetVar(
                                                        Ident(
                                                            "i",
                                                        ),
                                                    ),
                                                ),
                                                GetIndex(
                                                    GetVar(
                                                        Ident(
                                                            "arr",
                                                        ),
                                                    ),
                                                    GetVar(
                                                        Ident(
                                                            "min_idx",
                                                        ),
                                                    ),
                                                ),
                                            ),
                                        ),
                                        StmtExpr(
                                            SetIndex(
                                                None,
                                                GetIndex(
                                                    GetVar(
                                                        Ident(
                                                            "arr",
                                                        ),
                                                    ),
                                                    GetVar(
                                                        Ident(
                                                            "min_idx",
                                                        ),
                                                    ),
                                                ),
                                                GetVar(
                                                    Ident(
                                                        "tmp",
                                                    ),
                                                ),
                                            ),
                                        ),
                                    ],
                                ),
                            ),
                            StmtExpr(
                                SetVar(
                                    None,
                                    GetVar(
                                        Ident(
                                            "i",
                                        ),
                                    ),
                                    Infix(
                                        Add,
                                        GetVar(
                                            Ident(
                                                "i",
                                            ),
                                        ),
                                        Int32(
                                            1,
                                        ),
                                    ),
                                ),
                            ),
                        ],
                    ),
                    StmtExpr(
                        Return(
                            Some(
                                GetVar(
                                    Ident(
                                        "arr",
                                    ),
                                ),
                            ),
                        ),
                    ),
                ],
            ),
            [
                Ident(
                    "arr",
                ),
            ],
        ),
    ],
)
